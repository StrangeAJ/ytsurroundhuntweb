<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Search</title>
    <link rel="stylesheet" href="/styles.css" />
    <script
      src="https://kit.fontawesome.com/811bf099c0.js"
      crossorigin="anonymous"
    ></script>
    <!-- <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.8/axios.min.js"
      integrity="sha512-v8+bPcpk4Sj7CKB11+gK/FnsbgQ15jTwZamnBf/xDmiQDcgOIYufBo6Acu1y30vrk8gg5su4x0CG3zfPaq5Fcg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script> -->
  </head>
  <body>
    <h1>YouTube Search</h1>
    <button class="toggle-theme-button" onclick="toggleTheme()">
      Toggle Dark Theme
    </button>
    <form id="search-form">
      <input
        type="text"
        name="query"
        id="query"
        placeholder="Enter search term"
        required
      />
      <select name="invidious_url" id="invidious_url" required>
        <% instances.forEach(instance => { %>
        <option value="<%= instance.url %>">
          <%= instance.url %> <%= instance.type %>
        </option>
        <% }) %>
      </select>
      <button type="submit">Search</button>
    </form>
    <div id="progress-bar" class="progress-bar">
      <div class="progress-bar-inner"></div>
    </div>
    <% if (availableFormats.length > 0) { %>
    <script>
      updateProgress(<%= results.length %>);
      setTimeout(() => {
          hideProgressBar();
      }, 500);
    </script>
    <h2>Search Results</h2>
    <% availableFormats.forEach(result => { %>
    <h3>
      <a href="<%= result.url %>" target="_blank">
        <i class="fa-brands fa-youtube" style="color: gray"></i>
      </a>
      <%= result.name %>
    </h3>
    <table border="1" style="margin: 0 auto">
      <thead>
        <tr>
          <th>Format ID</th>
        </tr>
      </thead>
      <tbody>
        <% result.formats.forEach(format => { %>
        <tr>
          <td>
            <a
              href="<%= invidiousUrl %>/latest_version?id=<%= result.id %>&itag=<%= format %>"
            >
              <%= format %>
            </a>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
    <% }) %> <% } %>
    <script src="/scripts.js"></script>

  </body>
</html>
